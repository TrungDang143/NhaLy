<!-- Events & Characters Start -->
<div class="container-fluid py-5">
  <div class="container">
    <div class="text-center mx-auto mb-5" style="max-width: 600px;">
      <h1 class="display-6 mb-4">
        <i class="fas fa-users text-info me-3"></i>
        Sự kiện & nhân vật nổi bật
      </h1>
      <p class="text-muted">
        Khám phá những sự kiện lịch sử quan trọng và các nhân vật có ảnh hưởng lớn trong triều đại Lý
      </p>
    </div>

    <!-- Timeline -->
    <div class="row mb-5">
      <div class="col-12">
        <div class="timeline-container">
          <div class="timeline-line"></div>
          <div class="timeline-events">
            <div class="timeline-event" *ngFor="let event of events; let i = index" 
                 [class.timeline-left]="i % 2 === 0" 
                 [class.timeline-right]="i % 2 === 1">
              <div class="timeline-marker">
                <i class="fas fa-calendar-alt"></i>
              </div>
              <div class="timeline-content">
                <div class="timeline-card">
                  <div class="timeline-date">{{ event.date }}</div>
                  <h5>{{ event.title }}</h5>
                  <p class="text-muted">{{ event.description }}</p>
                  <div class="timeline-location" *ngIf="event.location">
                    <i class="fas fa-map-marker-alt me-2"></i>
                    {{ event.location }}
                  </div>
                  <button class="btn btn-outline-info btn-sm mt-2" (click)="viewEventDetail(event)">
                    <i class="fas fa-eye me-2"></i>
                    Chi tiết
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Featured Articles -->
    <div class="row">
      <div class="col-12">
        <h3 class="text-center mb-4">
          <i class="fas fa-newspaper me-2"></i>
          Bài Viết Nổi Bật
        </h3>
      </div>
    </div>

    <div class="row g-4">
      <div class="col-lg-4 col-md-6" *ngFor="let article of featuredArticles">
        <div class="card h-100 shadow-sm border-0 article-card">
          <img [src]="article.imageUrl" class="card-img-top" [alt]="article.title" 
               style="height: 200px; object-fit: cover;">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-start mb-2">
              <span class="badge" [ngClass]="getCategoryBadgeClass(article.category)">
                {{ getCategoryName(article.category) }}
              </span>
              <small class="text-muted">{{ article.createdDate | date:'dd/MM/yyyy' }}</small>
            </div>
            <h5 class="card-title">{{ article.title }}</h5>
            <p class="card-text text-muted">{{ article.summary }}</p>
            <div class="d-flex justify-content-between align-items-center">
              <small class="text-muted">
                <i class="fas fa-user me-1"></i>
                {{ article.author }}
              </small>
              <div class="article-tags">
                <span class="badge bg-light text-dark me-1" *ngFor="let tag of article.tags.slice(0, 2)">
                  {{ tag }}
                </span>
              </div>
            </div>
          </div>
          <div class="card-footer bg-transparent border-0">
            <button class="btn btn-primary btn-sm w-100" (click)="viewArticleDetail(article)">
              <i class="fas fa-book-open me-2"></i>
              Đọc bài viết
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Interactive Features -->
    <div class="row mt-5">
      <div class="col-md-6 mb-4">
        <div class="feature-card bg-gradient-primary text-white p-4 rounded-3 h-100">
          <div class="d-flex align-items-center mb-3">
            <i class="fas fa-search-location fa-3x me-3"></i>
            <div>
              <h4 class="mb-1">Bản Đồ Tương Tác</h4>
              <p class="mb-0">Khám phá các địa điểm lịch sử trên bản đồ</p>
            </div>
          </div>
          <button class="btn btn-light" (click)="openInteractiveMap()">
            <i class="fas fa-map me-2"></i>
            Mở bản đồ
          </button>
        </div>
      </div>
      <div class="col-md-6 mb-4">
        <div class="feature-card bg-gradient-success text-white p-4 rounded-3 h-100">
          <div class="d-flex align-items-center mb-3">
            <i class="fas fa-clock fa-3x me-3"></i>
            <div>
              <h4 class="mb-1">Dòng Thời Gian</h4>
              <p class="mb-0">Theo dõi diễn biến lịch sử theo thời gian</p>
            </div>
          </div>
          <button class="btn btn-light" (click)="openTimeline()">
            <i class="fas fa-history me-2"></i>
            Xem timeline
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Event Detail Modal -->
<div class="modal fade" id="eventDetailModal" tabindex="-1" *ngIf="selectedEvent">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          <i class="fas fa-calendar-alt text-info me-2"></i>
          {{ selectedEvent.title }}
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-4">
            <img [src]="selectedEvent.imageUrl" class="img-fluid rounded" [alt]="selectedEvent.title">
            <div class="mt-3">
              <div class="d-flex justify-content-between mb-2">
                <strong>Thời gian:</strong>
                <span class="badge bg-info">{{ selectedEvent.date }}</span>
              </div>
              <div class="d-flex justify-content-between mb-2" *ngIf="selectedEvent.location">
                <strong>Địa điểm:</strong>
                <span>{{ selectedEvent.location }}</span>
              </div>
            </div>
          </div>
          <div class="col-md-8">
            <h6 class="text-info mb-3">
              <i class="fas fa-info-circle me-2"></i>
              Mô tả sự kiện
            </h6>
            <p>{{ selectedEvent.description }}</p>
            
            <h6 class="text-info mb-3 mt-4">
              <i class="fas fa-star me-2"></i>
              Ý nghĩa lịch sử
            </h6>
            <p>{{ selectedEvent.significance }}</p>
            
            <div *ngIf="selectedEvent.relatedKings.length > 0">
              <h6 class="text-info mb-3">
                <i class="fas fa-crown me-2"></i>
                Vua liên quan
              </h6>
              <div class="d-flex flex-wrap gap-2">
                <span class="badge bg-warning text-dark" *ngFor="let kingId of selectedEvent.relatedKings">
                  {{ getKingName(kingId) }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Đóng
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Article Detail Modal -->
<div class="modal fade" id="articleDetailModal" tabindex="-1" *ngIf="selectedArticle">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ selectedArticle.title }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-3">
            <img [src]="selectedArticle.imageUrl" class="img-fluid rounded mb-3" [alt]="selectedArticle.title">
            <div class="article-meta">
              <p><strong>Tác giả:</strong> {{ selectedArticle.author }}</p>
              <p><strong>Ngày tạo:</strong> {{ selectedArticle.createdDate | date:'dd/MM/yyyy' }}</p>
              <p><strong>Danh mục:</strong> 
                <span class="badge" [ngClass]="getCategoryBadgeClass(selectedArticle.category)">
                  {{ getCategoryName(selectedArticle.category) }}
                </span>
              </p>
              <div class="mt-3">
                <strong>Tags:</strong><br>
                <span class="badge bg-light text-dark me-1 mt-1" *ngFor="let tag of selectedArticle.tags">
                  {{ tag }}
                </span>
              </div>
            </div>
          </div>
          <div class="col-md-9">
            <div class="article-content" [innerHTML]="selectedArticle.content"></div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-success" 
                *ngIf="selectedArticle.sketchfabId" 
                (click)="view3DModel(selectedArticle.sketchfabId)">
          <i class="fas fa-cube me-2"></i>
          Xem mô hình 3D
        </button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Đóng
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Events & Characters End -->